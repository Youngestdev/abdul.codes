<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="lang">
  <head>
    <title data-vue-tag="true">Building An SSO Model in FastAPI Applications - Abdul&#x27;s Musings</title><meta data-vue-tag="true" charset="utf-8"><meta data-vue-tag="true" name="generator" content="Gridsome v0.6.9"><meta data-vue-tag="true" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="true" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="true" data-key="description" name="description" content="A simple blog to pen my findings and idk idk."><meta data-vue-tag="true" name="google-site-verification" content="sIbGxCmGnUobPKM6wa8WJZaHqfW7XJZP6WUEDaIo90o"><meta data-vue-tag="true" name="description" content><meta data-vue-tag="true" name="twitter:card" content="summary"><meta data-vue-tag="true" name="twitter:creator" content="@kvng_zeez"><meta data-vue-tag="true" name="twitter:description" content><meta data-vue-tag="true" name="twitter:image" content=""><meta data-vue-tag="true" name="twitter:site" content="@kvng_zeez"><meta data-vue-tag="true" property="og:type" content="article"><meta data-vue-tag="true" property="og:title" content="Building An SSO Model in FastAPI Applications"><meta data-vue-tag="true" property="og:description" content><meta data-vue-tag="true" property="og:url" content="undefinedundefined"><link data-vue-tag="true" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Stylish&amp;display=swap"><link data-vue-tag="true" rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans&amp;display=swap"><link data-vue-tag="true" rel="favicon" href="https://res.cloudinary.com/adeshina/image/upload/v1597158363/x8kh4xqni1ktuc4mb3v7.ico"><script data-vue-tag="true" src="https://platform.twitter.com/widgets.js" async="true"></script><noscript data-vue-tag="true" ><style>.g-image--loading{display:none;}</style></noscript><link rel="preload" href="/assets/css/0.styles.c31b00c3.css" as="style"><link rel="preload" href="/assets/js/app.cfca3445.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.a02313ea.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.c976386a.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.cc2794a6.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--post-vue.52a6764f.js"><link rel="stylesheet" href="/assets/css/0.styles.c31b00c3.css">
  </head>
  <body data-vue-tag="">
    <div data-server-rendered="true" id="app" class="layout"><br><a id="go-back" aria-label="Go back" class="link">‚Üê Go Back</a><div class="post-title"><h1>Building An SSO Model in FastAPI Applications</h1><p class="post-date"> 4 July 2021 | 3 min read</p></div><!----><div class="post-content"><p><h2 id="current-status"><a href="#current-status" aria-hidden="true"><span class="icon icon-link"></span></a>Current Status</h2>
<p>This is a rough article. Once I have free time, I will rewrite the entire article to use the proper technologies I used.</p>
<h2 id="preamble"><a href="#preamble" aria-hidden="true"><span class="icon icon-link"></span></a>Preamble</h2>
<p>I'm currently working on a project. Ideally, the model of user authentication should be the traditional username and password. However, I'm a lazy dev, and I do not want to have to deal with the complexity of that model.</p>
<p>I have used applications that employ the Single Sign On model, and I find it fascinating. Interestingly, I don't really have an idea of how it worked then. I thought of a simple way, and I think it's sufficient.</p>
<blockquote>
<p>That said, I'll be writing a concise article on how I built an SSO model for a FastAPI Application in the future.</p>
</blockquote>
<h2 id="working-principle"><a href="#working-principle" aria-hidden="true"><span class="icon icon-link"></span></a>Working Principle</h2>
<p>For this model, a token will be generated by a function, tied to the requested user and then registered in the database.</p>
<p>The purpose of saving this in the database is to act as a point of validation when the sign-in link is used. That is, whenever a sign-in link is used, the application checks if it is saved in the database before proceeding to give a response.</p>
<p>I have tried to demonstrate this in the image below:</p>
<p><img src="https://res.cloudinary.com/laisi/image/upload/v1625402923/process_mr8vc4.svg" alt="Excaldiraw diagram of the working principle"></p>
<p>I must apologize ahead: In this article, I used an in-memory database. However, the concept is the same as when applied to a real database.</p>
<h2 id="prerequisite"><a href="#prerequisite" aria-hidden="true"><span class="icon icon-link"></span></a>Prerequisite</h2>
<ul>
<li>FastAPI </li>
</ul>
<h2 id="scaffold-your-application"><a href="#scaffold-your-application" aria-hidden="true"><span class="icon icon-link"></span></a>Scaffold your application</h2>
<p>The first step is to create an empty directory and scaffold an application:</p>
<div class="gridsome-highlight" data-language="console"><pre class="language-console"><code class="language-console">$ mkdir sso-app &amp;&amp; cd sso-app
$ python3 -m venv</code></pre></div>
<p>Activate the virtual environment and install the application dependencies:</p>
<div class="gridsome-highlight" data-language="console"><pre class="language-console"><code class="language-console">$ . venv/bin/activate
(venv)$ pip install fastapi uvicorn
(venv)$ pip freeze &gt; requirements.txt </code></pre></div>
<p>Create the routing file, and utilities file:</p>
<div class="gridsome-highlight" data-language="console"><pre class="language-console"><code class="language-console">(venv)$ touch {routes,utilities}.py</code></pre></div>
<h2 id="write-the-routes"><a href="#write-the-routes" aria-hidden="true"><span class="icon icon-link"></span></a>Write the routes</h2>
<p>I'll be having a route to:</p>
<ul>
<li>Add a new user</li>
<li>Request for a sign-in link</li>
<li>Sign a user in</li>
</ul>
<p>In <code class="language-text">routes.py</code>:</p>
<div class="gridsome-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI

<span class="token keyword">from</span> utilities <span class="token keyword">import</span> generate_token

users <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
login_tokens <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

router <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span>
    title<span class="token operator">=</span><span class="token string">"SSO Application"</span><span class="token punctuation">,</span>
    description<span class="token operator">=</span><span class="token string">"Simple application demo on how SSO works"</span>
<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@router<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">"/new/"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">new_user</span><span class="token punctuation">(</span>user<span class="token punctuation">:</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    user_id <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    users<span class="token punctuation">[</span>user_id<span class="token punctuation">]</span> <span class="token operator">=</span> user

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"User data successfully added"</span>
    <span class="token punctuation">}</span>


<span class="token decorator annotation punctuation">@router<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">"/sso"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_sso_link</span><span class="token punctuation">(</span>user_id<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> users<span class="token punctuation">[</span>user_id<span class="token punctuation">]</span><span class="token punctuation">:</span>
        token <span class="token operator">=</span> <span class="token keyword">await</span> generate_token<span class="token punctuation">(</span>user_id<span class="token punctuation">)</span>
        login_tokens<span class="token punctuation">.</span>append<span class="token punctuation">(</span>token<span class="token punctuation">)</span>
        <span class="token keyword">return</span> token
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token string">"error"</span><span class="token punctuation">:</span> <span class="token string">"User with supplied ID doesn't exist"</span>
    <span class="token punctuation">}</span>


<span class="token decorator annotation punctuation">@router<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">"/sso/"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">sign_in</span><span class="token punctuation">(</span>token<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> token <span class="token keyword">in</span> login_tokens<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"User logged in successfully."</span>
        <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token string">"error"</span><span class="token punctuation">:</span> <span class="token string">"Invalid token passed"</span>
    <span class="token punctuation">}</span></code></pre></div>
<h2 id="write-the-utility-function"><a href="#write-the-utility-function" aria-hidden="true"><span class="icon icon-link"></span></a>Write the utility function</h2>
<p>The utility function is named <code class="language-text">generate_token</code>. It is responsible for generating identifiers.</p>
<p>In <code class="language-text">utilities.py</code>:</p>
<div class="gridsome-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token keyword">import</span> random
<span class="token keyword">import</span> string

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">generate_token</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    length_of_token <span class="token operator">=</span> <span class="token number">12</span>
    identifier <span class="token operator">=</span> <span class="token string">""</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length_of_token<span class="token punctuation">)</span><span class="token punctuation">:</span>
        identifier <span class="token operator">+=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_letters<span class="token punctuation">)</span>
    <span class="token keyword">return</span> identifier</code></pre></div>
<h2 id="start-your-application"><a href="#start-your-application" aria-hidden="true"><span class="icon icon-link"></span></a>Start your application</h2>
<div class="gridsome-highlight" data-language="console"><pre class="language-console"><code class="language-console">(venv)$ uvicorn routes:router --host 0.0.0.0 --port 8080</code></pre></div>
<h2 id="testing"><a href="#testing" aria-hidden="true"><span class="icon icon-link"></span></a>Testing</h2>
<ol>
<li>Add a new user:</li>
</ol>
<div class="gridsome-highlight" data-language="console"><pre class="language-console"><code class="language-console">$ curl -X &#39;POST&#39; \
  &#39;http://0.0.0.0:8080/new/&#39; \
  -H &#39;accept: application/json&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -d &#39;{
  &quot;username&quot;: &quot;Abdulazeez&quot;
}&#39;</code></pre></div>
<ol start="2">
<li>Get an SSO token</li>
</ol>
<div class="gridsome-highlight" data-language="console"><pre class="language-console"><code class="language-console">curl -X &#39;POST&#39; \
  &#39;http://0.0.0.0:8080/sso?user_id=1&#39; \
  -H &#39;accept: application/json&#39; \
  -d &#39;&#39;</code></pre></div>
<p>The token returned is: <code class="language-text">KDZfHjQAdiFl</code></p>
<ol start="3">
<li>Sign In</li>
</ol>
<div class="gridsome-highlight" data-language="console"><pre class="language-console"><code class="language-console">curl -X &#39;GET&#39; \
  &#39;http://0.0.0.0:8080/sso/?token=KDZfHjQAdiFl&#39; \
  -H &#39;accept: application/json&#39;</code></pre></div>
<p>Response:</p>
<div class="gridsome-highlight" data-language="console"><pre class="language-console"><code class="language-console">{
  &quot;message&quot;: &quot;User logged in successfully.&quot;
}</code></pre></div>
<ol start="4">
<li>Using a wrong token:</li>
</ol>
<div class="gridsome-highlight" data-language="console"><pre class="language-console"><code class="language-console">curl -X &#39;GET&#39; \
  &#39;http://0.0.0.0:8080/sso/?token=fKDZfHjQAdiFl&#39; \
  -H &#39;accept: application/json&#39;</code></pre></div>
<p>Response:</p>
<div class="gridsome-highlight" data-language="console"><pre class="language-console"><code class="language-console">{
  &quot;error&quot;: &quot;Invalid token passed&quot;
}</code></pre></div>
<h2 id="conclusion"><a href="#conclusion" aria-hidden="true"><span class="icon icon-link"></span></a>Conclusion</h2>
<p>A proper conclusion will be written once I have completed this draft. Until then, I'll say check back frequently.</p>
<h2 id="references"><a href="#references" aria-hidden="true"><span class="icon icon-link"></span></a>References</h2>
<ul>
<li>My brain</li>
<li>Shortener inspiration: <a href="https://dev.to/lordghostx/build-and-deploy-a-serverless-url-shortener-with-python-and-fauna-3077" target="_blank" rel="nofollow noopener noreferrer">https://dev.to/lordghostx/build-and-deploy-a-serverless-url-shortener-with-python-and-fauna-3077</a></li>
</ul>
</p><hr><div id="disqus_thread"></div></div><div class="footer"><p>
      Check my <a href="//github.com/Youngestdev" class="link">GitHub</a></p></div></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"id":"59a389c2b7b23ccc113fb19498be7581","title":"Building An SSO Model in FastAPI Applications","content":"\u003Ch2 id=\"current-status\"\u003E\u003Ca href=\"#current-status\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECurrent Status\u003C\u002Fh2\u003E\n\u003Cp\u003EThis is a rough article. Once I have free time, I will rewrite the entire article to use the proper technologies I used.\u003C\u002Fp\u003E\n\u003Ch2 id=\"preamble\"\u003E\u003Ca href=\"#preamble\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPreamble\u003C\u002Fh2\u003E\n\u003Cp\u003EI'm currently working on a project. Ideally, the model of user authentication should be the traditional username and password. However, I'm a lazy dev, and I do not want to have to deal with the complexity of that model.\u003C\u002Fp\u003E\n\u003Cp\u003EI have used applications that employ the Single Sign On model, and I find it fascinating. Interestingly, I don't really have an idea of how it worked then. I thought of a simple way, and I think it's sufficient.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EThat said, I'll be writing a concise article on how I built an SSO model for a FastAPI Application in the future.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch2 id=\"working-principle\"\u003E\u003Ca href=\"#working-principle\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EWorking Principle\u003C\u002Fh2\u003E\n\u003Cp\u003EFor this model, a token will be generated by a function, tied to the requested user and then registered in the database.\u003C\u002Fp\u003E\n\u003Cp\u003EThe purpose of saving this in the database is to act as a point of validation when the sign-in link is used. That is, whenever a sign-in link is used, the application checks if it is saved in the database before proceeding to give a response.\u003C\u002Fp\u003E\n\u003Cp\u003EI have tried to demonstrate this in the image below:\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fres.cloudinary.com\u002Flaisi\u002Fimage\u002Fupload\u002Fv1625402923\u002Fprocess_mr8vc4.svg\" alt=\"Excaldiraw diagram of the working principle\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EI must apologize ahead: In this article, I used an in-memory database. However, the concept is the same as when applied to a real database.\u003C\u002Fp\u003E\n\u003Ch2 id=\"prerequisite\"\u003E\u003Ca href=\"#prerequisite\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPrerequisite\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003EFastAPI \u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"scaffold-your-application\"\u003E\u003Ca href=\"#scaffold-your-application\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EScaffold your application\u003C\u002Fh2\u003E\n\u003Cp\u003EThe first step is to create an empty directory and scaffold an application:\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"console\"\u003E\u003Cpre class=\"language-console\"\u003E\u003Ccode class=\"language-console\"\u003E$ mkdir sso-app &amp;&amp; cd sso-app\n$ python3 -m venv\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EActivate the virtual environment and install the application dependencies:\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"console\"\u003E\u003Cpre class=\"language-console\"\u003E\u003Ccode class=\"language-console\"\u003E$ . venv\u002Fbin\u002Factivate\n(venv)$ pip install fastapi uvicorn\n(venv)$ pip freeze &gt; requirements.txt \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ECreate the routing file, and utilities file:\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"console\"\u003E\u003Cpre class=\"language-console\"\u003E\u003Ccode class=\"language-console\"\u003E(venv)$ touch {routes,utilities}.py\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2 id=\"write-the-routes\"\u003E\u003Ca href=\"#write-the-routes\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EWrite the routes\u003C\u002Fh2\u003E\n\u003Cp\u003EI'll be having a route to:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EAdd a new user\u003C\u002Fli\u003E\n\u003Cli\u003ERequest for a sign-in link\u003C\u002Fli\u003E\n\u003Cli\u003ESign a user in\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EIn \u003Ccode class=\"language-text\"\u003Eroutes.py\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"python\"\u003E\u003Cpre class=\"language-python\"\u003E\u003Ccode class=\"language-python\"\u003E\u003Cspan class=\"token keyword\"\u003Efrom\u003C\u002Fspan\u003E fastapi \u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E FastAPI\n\n\u003Cspan class=\"token keyword\"\u003Efrom\u003C\u002Fspan\u003E utilities \u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E generate_token\n\nusers \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\nlogin_tokens \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\nrouter \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E FastAPI\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\n    title\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"SSO Application\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n    description\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"Simple application demo on how SSO works\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\n\u003Cspan class=\"token decorator annotation punctuation\"\u003E@router\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Epost\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"\u002Fnew\u002F\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Enew_user\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Euser\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Edict\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    user_id \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Elen\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eusers\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\n    users\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Euser_id\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E user\n\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token string\"\u003E\"message\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"User data successfully added\"\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\n\n\u003Cspan class=\"token decorator annotation punctuation\"\u003E@router\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Epost\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"\u002Fsso\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Eget_sso_link\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Euser_id\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Eint\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E users\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Euser_id\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n        token \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E generate_token\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Euser_id\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n        login_tokens\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eappend\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Etoken\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E token\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token string\"\u003E\"error\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"User with supplied ID doesn't exist\"\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\n\n\u003Cspan class=\"token decorator annotation punctuation\"\u003E@router\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eget\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"\u002Fsso\u002F\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Esign_in\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Etoken\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Estr\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E token \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E login_tokens\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\"token string\"\u003E\"message\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"User logged in successfully.\"\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token string\"\u003E\"error\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"Invalid token passed\"\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2 id=\"write-the-utility-function\"\u003E\u003Ca href=\"#write-the-utility-function\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EWrite the utility function\u003C\u002Fh2\u003E\n\u003Cp\u003EThe utility function is named \u003Ccode class=\"language-text\"\u003Egenerate_token\u003C\u002Fcode\u003E. It is responsible for generating identifiers.\u003C\u002Fp\u003E\n\u003Cp\u003EIn \u003Ccode class=\"language-text\"\u003Eutilities.py\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"python\"\u003E\u003Cpre class=\"language-python\"\u003E\u003Ccode class=\"language-python\"\u003E\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E random\n\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E string\n\n\u003Cspan class=\"token keyword\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Edef\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Egenerate_token\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token builtin\"\u003Eid\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Estr\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n    length_of_token \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E12\u003C\u002Fspan\u003E\n    identifier \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\n\n    \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E i \u003Cspan class=\"token keyword\"\u003Ein\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Erange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elength_of_token\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E:\u003C\u002Fspan\u003E\n        identifier \u003Cspan class=\"token operator\"\u003E+=\u003C\u002Fspan\u003E random\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Echoice\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Estring\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eascii_letters\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E identifier\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2 id=\"start-your-application\"\u003E\u003Ca href=\"#start-your-application\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EStart your application\u003C\u002Fh2\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"console\"\u003E\u003Cpre class=\"language-console\"\u003E\u003Ccode class=\"language-console\"\u003E(venv)$ uvicorn routes:router --host 0.0.0.0 --port 8080\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2 id=\"testing\"\u003E\u003Ca href=\"#testing\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ETesting\u003C\u002Fh2\u003E\n\u003Col\u003E\n\u003Cli\u003EAdd a new user:\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"console\"\u003E\u003Cpre class=\"language-console\"\u003E\u003Ccode class=\"language-console\"\u003E$ curl -X &#39;POST&#39; \\\n  &#39;http:\u002F\u002F0.0.0.0:8080\u002Fnew\u002F&#39; \\\n  -H &#39;accept: application\u002Fjson&#39; \\\n  -H &#39;Content-Type: application\u002Fjson&#39; \\\n  -d &#39;{\n  &quot;username&quot;: &quot;Abdulazeez&quot;\n}&#39;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Col start=\"2\"\u003E\n\u003Cli\u003EGet an SSO token\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"console\"\u003E\u003Cpre class=\"language-console\"\u003E\u003Ccode class=\"language-console\"\u003Ecurl -X &#39;POST&#39; \\\n  &#39;http:\u002F\u002F0.0.0.0:8080\u002Fsso?user_id=1&#39; \\\n  -H &#39;accept: application\u002Fjson&#39; \\\n  -d &#39;&#39;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EThe token returned is: \u003Ccode class=\"language-text\"\u003EKDZfHjQAdiFl\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Col start=\"3\"\u003E\n\u003Cli\u003ESign In\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"console\"\u003E\u003Cpre class=\"language-console\"\u003E\u003Ccode class=\"language-console\"\u003Ecurl -X &#39;GET&#39; \\\n  &#39;http:\u002F\u002F0.0.0.0:8080\u002Fsso\u002F?token=KDZfHjQAdiFl&#39; \\\n  -H &#39;accept: application\u002Fjson&#39;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EResponse:\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"console\"\u003E\u003Cpre class=\"language-console\"\u003E\u003Ccode class=\"language-console\"\u003E{\n  &quot;message&quot;: &quot;User logged in successfully.&quot;\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Col start=\"4\"\u003E\n\u003Cli\u003EUsing a wrong token:\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"console\"\u003E\u003Cpre class=\"language-console\"\u003E\u003Ccode class=\"language-console\"\u003Ecurl -X &#39;GET&#39; \\\n  &#39;http:\u002F\u002F0.0.0.0:8080\u002Fsso\u002F?token=fKDZfHjQAdiFl&#39; \\\n  -H &#39;accept: application\u002Fjson&#39;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EResponse:\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"console\"\u003E\u003Cpre class=\"language-console\"\u003E\u003Ccode class=\"language-console\"\u003E{\n  &quot;error&quot;: &quot;Invalid token passed&quot;\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2 id=\"conclusion\"\u003E\u003Ca href=\"#conclusion\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EConclusion\u003C\u002Fh2\u003E\n\u003Cp\u003EA proper conclusion will be written once I have completed this draft. Until then, I'll say check back frequently.\u003C\u002Fp\u003E\n\u003Ch2 id=\"references\"\u003E\u003Ca href=\"#references\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EReferences\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003EMy brain\u003C\u002Fli\u003E\n\u003Cli\u003EShortener inspiration: \u003Ca href=\"https:\u002F\u002Fdev.to\u002Flordghostx\u002Fbuild-and-deploy-a-serverless-url-shortener-with-python-and-fauna-3077\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fdev.to\u002Flordghostx\u002Fbuild-and-deploy-a-serverless-url-shortener-with-python-and-fauna-3077\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n","date":"4 July 2021","timeToRead":3,"image":null}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.cfca3445.js" defer></script><script src="/assets/js/page--src--templates--post-vue.a02313ea.js" defer></script>
  </body>
</html>
